name: Peer Review

on:
  pull_request:
    branches: [ master ]

jobs:
  integration-tests:
    name: Build
    runs-on: ubuntu-latest
    steps:
    - name: Check out code into the Go module directory
      uses: actions/checkout@v2
      run: go mod tidy

    - name: Deploy the testing services
      run: docker-compose -f docker-compose-integration-tests.yml up -d

    - name: Running the integration tests
      run: docker-compose -f docker-compose-integration-tests.yml run tests go test -tags=integration ./...

    - name: stop the testing services
      run: docker-compose -f docker-compose-integration-tests.yml stop
